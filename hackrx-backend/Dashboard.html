<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.1/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.2.0/dist/chartjs-adapter-luxon.min.js"></script>
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #10b981;
            --info: #3b82f6;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        .sidebar {
            transition: all 0.3s;
        }
        
        .sidebar-mini {
            width: 80px;
        }
        
        .sidebar-mini .nav-text {
            display: none;
        }
        
        .sidebar-full {
            width: 260px;
        }
        
        .kanban-column {
            min-height: 500px;
        }
        
        .kanban-card {
            transition: transform 0.2s;
        }
        
        .kanban-card:hover {
            transform: translateY(-2px);
        }
        
        .task-progress {
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar sidebar-full bg-gray-900 text-white shadow-xl">
            <div class="flex items-center justify-between p-4 border-b border-gray-700">
                <div class="flex items-center">
                    <img src="https://placehold.co/40x40" alt="Project management dashboard logo with blue gradient background" class="rounded-lg mr-3">
                    <span class="text-xl font-bold">ProTrack</span>
                </div>
                <button id="toggleSidebar" class="text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <nav class="mt-6">
                <div class="px-4">
                    <div class="mb-6">
                        <h3 class="text-xs uppercase font-semibold text-gray-400 px-2 mb-4">Dashboard</h3>
                        <ul>
                            <li class="mb-1">
                                <a href="#" class="flex items-center p-2 rounded-lg bg-gray-800 text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                                    </svg>
                                    <span class="ml-3 nav-text">Overview</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xs uppercase font-semibold text-gray-400 px-2 mb-4">Projects</h3>
                        <ul>
                            <li class="mb-1">
                                <a href="#projects" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2H4a1 1 0 110-2V4zm3 1h2v2H7V5zm4 0h2v2h-2V5zM7 9h2v2H7V9zm4 0h2v2h-2V9zm-4 4h2v2H7v-2zm4 0h2v2h-2v-2z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="ml-3 nav-text">All Projects</span>
                                    <span id="totalProjectsCount" class="bg-gray-700 text-white text-xs font-medium px-2 py-0.5 rounded-full ml-auto nav-text">0</span>
                                </a>
                            </li>
                            <li class="mb-1">
                                <a href="#create-project" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="ml-3 nav-text">New Project</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xs uppercase font-semibold text-gray-400 px-2 mb-4">Tasks</h3>
                        <ul>
                            <li class="mb-1">
                                <a href="#tasks" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="ml-3 nav-text">My Tasks</span>
                                </a>
                            </li>
                            <li class="mb-1">
                                <a href="#kanban" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                                    </svg>
                                    <span class="ml-3 nav-text">Kanban Board</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-xs uppercase font-semibold text-gray-400 px-2 mb-4">Team</h3>
                        <ul>
                            <li class="mb-1">
                                <a href="#team" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v1h8v-1zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-1a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v1h-3zM4.75 12.094A5.973 5.973 0 004 15v1H1v-1a3 3 0 013.75-2.906z" />
                                    </svg>
                                    <span class="ml-3 nav-text">Members</span>
                                </a>
                            </li>
                            <li class="mb-1">
                                <a href="#messages" class="flex items-center p-2 rounded-lg hover:bg-gray-800 text-gray-300 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="ml-3 nav-text">Messages</span>
                                    <span class="bg-blue-500 text-white text-xs font-medium px-2 py-0.5 rounded-full ml-auto nav-text">5</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-700">
                <div class="flex items-center">
                    <img src="https://placehold.co/40x40" alt="User profile picture of admin with professional appearance" class="rounded-full mr-3">
                    <div class="nav-text">
                        <p class="font-medium">Admin User</p>
                        <p class="text-xs text-gray-400">admin@example.com</p>
                    </div>
                    <button class="ml-auto text-gray-400 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>s
        
        <!-- Main Content -->
        <div class="flex-1 overflow-auto">
            <!-- Top Navigation -->
            <header class="bg-white shadow-sm">
                <div class="flex items-center justify-between px-6 py-4">
                    <div class="flex items-center">
                        <h1 class="text-xl font-bold text-gray-800">Dashboard Overview</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input type="text" id="projectSearch" placeholder="Search projects..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-2.5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <button class="p-2 rounded-full bg-gray-100 hover:bg-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" />
                            </svg>
                        </button>
                        <button class="p-2 rounded-full bg-gray-100 hover:bg-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                                <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                </div>
            </header>
            
            <!-- Main Content Area -->
            <main class="p-6">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg bg-blue-100 text-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                                </svg>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Total Projects</h3>
                                <p id="totalProjectsSummary" class="text-2xl font-semibold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg bg-green-100 text-green-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Completed Projects</h3>
                                <p id="completedProjectsSummary" class="text-2xl font-semibold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg bg-yellow-100 text-yellow-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Ongoing Projects</h3>
                                <p id="ongoingProjectsSummary" class="text-2xl font-semibold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg bg-red-100 text-red-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                </svg>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-sm font-medium text-gray-500">Upcoming Deadlines</h3>
                                <p id="upcomingDeadlinesSummary" class="text-2xl font-semibold text-gray-900">0</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts and Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-lg shadow p-6 lg:col-span-2">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-lg font-semibold text-gray-800">Project Status</h2>
                            <select class="border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>This Month</option>
                                <option>Last Month</option>
                                <option>Last 6 Months</option>
                            </select>
                        </div>
                        <div class="h-80">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-lg font-semibold text-gray-800">Recent Activity</h2>
                            <button class="text-sm text-blue-600 hover:text-blue-800">View All</button>
                        </div>
                        <div id="recentActivityList" class="space-y-4">
                            <!-- Recent Activity items will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Projects Section -->
                <div class="mb-8" id="projects">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-semibold text-gray-800">Recent Projects</h2>
                        <button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                            </svg>
                            New Project
                        </button>
                    </div>
                    
                    <div id="projectsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Project Cards will be loaded here -->
                    </div>
                </div>
                
                <!-- Project Details Section -->
                <div class="mb-8 hidden" id="project-details">
                    <div class="flex items-center justify-between mb-4">
                        <h2 id="projectDetailTitle" class="text-lg font-semibold text-gray-800"></h2>
                        <div>
                            <button class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-1.5 h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                                    <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                                </svg>
                                Edit
                            </button>
                            <button id="backToProjects" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ml-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-1.5 h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                </svg>
                                Back
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow overflow-hidden">
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h3 class="text-md font-medium text-gray-900 mb-4">Project Information</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Project Description</label>
                                            <p id="projectDetailDescription" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Department</label>
                                            <p id="projectDetailDepartment" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Project Type</label>
                                            <p id="projectDetailType" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Supervisor</label>
                                            <p id="projectDetailSupervisor" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h3 class="text-md font-medium text-gray-900 mb-4">Timeline & Progress</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Start Date</label>
                                            <p id="projectDetailStartDate" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">End Date</label>
                                            <p id="projectDetailEndDate" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Status</label>
                                            <p id="projectDetailStatus" class="mt-1 text-sm text-gray-900"></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-500">Progress</label>
                                            <div class="mt-1">
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div id="projectDetailProgress" class="bg-blue-600 h-2 rounded-full task-progress" style="width: 0%"></div>
                                                </div>
                                                <p id="projectDetailProgressText" class="mt-1 text-xs text-gray-500">0% completed</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Team Members -->
                            <div class="mt-8">
                                <h3 class="text-md font-medium text-gray-900 mb-4">Team Members</h3>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tasks</th>
                                            </tr>
                                        </thead>
                                        <tbody id="projectDetailTeamMembers" class="bg-white divide-y divide-gray-200">
                                            <!-- Team members will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Tasks & Milestones -->
                            <div class="mt-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-md font-medium text-gray-900">Tasks & Milestones</h3>
                                    <button id="newTaskButton" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-1.5 h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                        </svg>
                                        New Task
                                    </button>
                                </div>
                                
                                <!-- New Task Modal (Hidden by default) -->
                                <div id="newTaskModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
                                    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                                        <!-- Background overlay -->
                                        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
                                        <!-- Modal panel -->
                                        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                                            <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                                <div class="sm:flex sm:items-start">
                                                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                                                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">New Task</h3>
                                                        <div class="mt-2">
                                                            <div class="space-y-4">
                                                                <div>
                                                                    <label for="taskTitle" class="block text-sm font-medium text-gray-700">Task Title</label>
                                                                    <input type="text" name="taskTitle" id="taskTitle" class="mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                                                                </div>
                                                                <div>
                                                                    <label for="taskDescription" class="block text-sm font-medium text-gray-700">Description</label>
                                                                    <textarea id="taskDescription" name="taskDescription" rows="3" class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border-gray-300 rounded-md"></textarea>
                                                                </div>
                                                                <div>
                                                                    <label for="taskAssignee" class="block text-sm font-medium text-gray-700">Assign To</label>
                                                                    <select id="taskAssignee" name="taskAssignee" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                                                        <option value="Sarah Johnson">Sarah Johnson</option>
                                                                        <option value="Michael Chen">Michael Chen</option>
                                                                        <option value="Emma Williams">Emma Williams</option>
                                                                        <option value="David Kim">David Kim</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label for="taskPriority" class="block text-sm font-medium text-gray-700">Priority</label>
                                                                    <select id="taskPriority" name="taskPriority" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                                                        <option value="High">High</option>
                                                                        <option value="Medium">Medium</option>
                                                                        <option value="Low">Low</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label for="taskDeadline" class="block text-sm font-medium text-gray-700">Deadline</label>
                                                                    <input type="date" name="taskDeadline" id="taskDeadline" class="mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                                <button type="button" id="createTaskButton" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm">
                                                    Create Task
                                                </button>
                                                <button id="cancelTaskButton" type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                                                    Cancel
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Kanban Board -->
                                <div class="mt-6" id="kanban">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <!-- To Do Column -->
                                        <div class="bg-gray-50 p-4 rounded-lg kanban-column">
                                            <div class="flex items-center justify-between mb-4">
                                                <h4 class="font-medium text-gray-700">To Do</h4>
                                                <span id="todoCount" class="inline-flex items-center justify-center h-6 w-6 rounded-full bg-gray-200 text-xs font-medium text-gray-700">0</span>
                                            </div>
                                            <div id="todoTasks" class="space-y-3">
                                                <!-- To Do Tasks will be loaded here -->
                                            </div>
                                        </div>
                                        
                                        <!-- In Progress Column -->
                                        <div class="bg-gray-50 p-4 rounded-lg kanban-column">
                                            <div class="flex items-center justify-between mb-4">
                                                <h4 class="font-medium text-gray-700">In Progress</h4>
                                                <span id="inProgressCount" class="inline-flex items-center justify-center h-6 w-6 rounded-full bg-gray-200 text-xs font-medium text-gray-700">0</span>
                                            </div>
                                            <div id="inProgressTasks" class="space-y-3">
                                                <!-- In Progress Tasks will be loaded here -->
                                            </div>
                                        </div>
                                        
                                        <!-- Done Column -->
                                        <div class="bg-gray-50 p-4 rounded-lg kanban-column">
                                            <div class="flex items-center justify-between mb-4">
                                                <h4 class="font-medium text-gray-700">Done</h4>
                                                <span id="doneCount" class="inline-flex items-center justify-center h-6 w-6 rounded-full bg-gray-200 text-xs font-medium text-gray-700">0</span>
                                            </div>
                                            <div id="doneTasks" class="space-y-3">
                                                <!-- Done Tasks will be loaded here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Files & Documents -->
                            <div class="mt-8">
                                <h3 class="text-md font-medium text-gray-900 mb-4">Files & Documents</h3>
                                <div id="projectDetailFiles" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <!-- Files will be loaded here -->
                                </div>
                            </div>
                            
                            <!-- Discussion -->
                            <div class="mt-8">
                                <h3 class="text-md font-medium text-gray-900 mb-4">Discussion</h3>
                                <div class="bg-white rounded-lg shadow p-6">
                                    <div id="discussionComments" class="space-y-4">
                                        <!-- Comments will be loaded here -->
                                    </div>
                                    
                                    <!-- New Comment Form -->
                                    <div class="mt-6">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <img src="https://placehold.co/40x40" alt="Current user avatar" class="h-10 w-10 rounded-full">
                                            </div>
                                            <div class="ml-4 flex-1">
                                                <div class="border border-gray-300 rounded-lg shadow-sm overflow-hidden">
                                                    <label for="comment" class="sr-only">Add your comment</label>
                                                    <textarea id="commentInput" name="comment" rows="3" class="py-3 px-4 block w-full focus:outline-none focus:ring-1 focus:ring-blue-500" placeholder="Add your comment..."></textarea>
                                                    <div class="px-3 py-2 bg-gray-50 flex justify-between">
                                                        <div class="flex-shrink-0">
                                                            <button type="button" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                                                <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-2 h-5 w-5 text-gray-400" fill="none" viewBox="0 0 20 20" stroke="currentColor">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                                                                </svg>
                                                                Attach
                                                            </button>
                                                        </div>
                                                        <button type="button" id="postCommentButton" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                                            Post
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Calendar Section -->
                <div class="mb-8" id="calendar">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-semibold text-gray-800">Upcoming Deadlines</h2>
                        <div class="flex items-center space-x-2">
                            <select class="border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>Month View</option>
                                <option>Week View</option>
                                <option>Day View</option>
                            </select>
                            <button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-2 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                                Add Event
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow overflow-hidden">
                        <div class="grid grid-cols-7 divide-x divide-gray-200 border-b border-gray-200">
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Sun</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Mon</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Tue</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Wed</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Thu</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Fri</div>
                            <div class="text-xs font-medium text-gray-500 uppercase tracking-wider text-center py-2">Sat</div>
                        </div>
                        <div id="calendarGrid" class="grid grid-cols-7 divide-x divide-gray-200">
                            <!-- Calendar days and events will be loaded here -->
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-4">
        <div class="container mx-auto text-center">
            <p class="text-sm">
                &copy; 2023 ProTrack. All rights reserved.
            </p>
            <div class="mt-2">
                <a href="#" class="text-gray-400 hover:text-white text-sm mx-2">Privacy Policy</a>
                <span class="text-gray-400">|</span>
                <a href="#" class="text-gray-400 hover:text-white text-sm mx-2">Terms of Service</a>
            </div>
        </div>
    </footer>

    <script>
        const DateTime = luxon.DateTime;

        // --- Data Mockup (Replace with API calls in a real app) ---
        let projects = [
            {
                id: 'ai-chatbot',
                title: 'AI Healthcare Chatbot',
                status: 'In Progress',
                description: 'Developing an AI-powered chatbot that can assist in patient triage, provide basic healthcare information, and connect patients with appropriate medical professionals based on their symptoms and needs.',
                image: 'https://placehold.co/600x300/4f46e5/ffffff?text=AI+Chatbot',
                progress: 60,
                dueDate: '2025-09-15',
                department: 'Computer Science & Healthcare',
                type: 'Research Project',
                supervisor: 'Prof. Jennifer Wilson',
                team: [
                    { name: 'Sarah Johnson', role: 'Lead Developer', email: 'sarah.johnson@univ.edu', tasksCount: 5, avatar: 'https://placehold.co/40x40/ef4444/ffffff?text=SJ' },
                    { name: 'Michael Chen', role: 'Backend', email: 'michael.chen@univ.edu', tasksCount: 3, avatar: 'https://placehold.co/40x40/3b82f6/ffffff?text=MC' },
                    { name: 'Emma Williams', role: 'UI/UX', email: 'emma.williams@univ.edu', tasksCount: 4, avatar: 'https://placehold.co/40x40/8b5cf6/ffffff?text=EW' },
                    { name: 'David Kim', role: 'Research', email: 'david.kim@univ.edu', tasksCount: 2, avatar: 'https://placehold.co/40x40/f59e0b/ffffff?text=DK' }
                ],
                tasks: [
                    { id: 'task1', title: 'NLP Module Integration', description: 'Integrate the trained NLP model for symptom analysis', assignee: 'Michael Chen', dueDate: '2025-08-25', priority: 'High', status: 'To Do' },
                    { id: 'task2', title: 'User Testing Session', description: 'Conduct testing with healthcare professionals', assignee: 'Sarah Johnson', dueDate: '2025-08-30', priority: 'Medium', status: 'To Do' },
                    { id: 'task3', title: 'Patient Onboarding Flow', description: 'Design and implement onboarding process', assignee: 'Emma Williams', dueDate: '2025-08-20', priority: 'High', status: 'In Progress' },
                    { id: 'task4', title: 'Data Privacy Compliance', description: 'Implement GDPR and HIPAA compliance measures', assignee: 'David Kim', dueDate: '2025-08-28', priority: 'Medium', status: 'In Progress' },
                    { id: 'task5', title: 'Initial Research', description: 'Complete market and competitor analysis', assignee: 'David Kim', dueDate: '2025-08-05', priority: 'Low', status: 'Done' },
                    { id: 'task6', title: 'UI Wireframes', description: 'Design all interface screens', assignee: 'Emma Williams', dueDate: '2025-08-10', priority: 'High', status: 'Done' }
                ],
                files: [
                    { name: 'Project Proposal', type: 'PDF', size: '2.4 MB', uploaded: '2025-08-02', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`, bgColor: 'bg-blue-100', textColor: 'text-blue-600' },
                    { name: 'UI Mockups', type: 'PNG', size: '5.1 MB', uploaded: '2025-08-12', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>`, bgColor: 'bg-purple-100', textColor: 'text-purple-600' },
                    { name: 'Research Findings', type: 'DOCX', size: '1.8 MB', uploaded: '2025-08-08', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`, bgColor: 'bg-green-100', textColor: 'text-green-600' },
                    { name: 'Brand Assets', type: 'ZIP', size: '12.7 MB', uploaded: '2025-08-15', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a1 1 0 011.414 0l2.829 2.829a1 1 0 010 1.414l-8.486 8.485M7 17h.01" /></svg>`, bgColor: 'bg-red-100', textColor: 'text-red-600' }
                ],
                discussion: [
                    { user: 'Sarah Johnson', avatar: 'https://placehold.co/40x40/ef4444/ffffff?text=SJ', time: '2 hours ago', text: 'Has everyone reviewed the new NLP integration requirements? Michael, can you confirm if we have all the API documentation we need for this?' },
                    { user: 'Michael Chen', avatar: 'https://placehold.co/40x40/3b82f6/ffffff?text=MC', time: '1 hour ago', text: 'Yes, I\'ve gone through them. We have most of what we need, but we\'ll require the clinical terminology dataset from the research team. David, do you have an ETA on when that will be available?', replies: [
                        { user: 'David Kim', avatar: 'https://placehold.co/40x40/f59e0b/ffffff?text=DK', time: '45 minutes ago', text: 'We\'re finalizing the dataset now. Expect it by Friday at the latest. I\'ll send it over as soon as it\'s validated.' }
                    ]}
                ]
            },
            {
                id: 'ecommerce-platform',
                title: 'E-commerce Platform',
                status: 'Pending',
                description: 'Building a modern e-commerce platform with AI recommendations and seamless checkout.',
                image: 'https://placehold.co/600x300/10b981/ffffff?text=E-commerce',
                progress: 15,
                dueDate: '2025-10-30',
                department: 'Software Development',
                type: 'Product Development',
                supervisor: 'Dr. Emily White',
                team: [
                    { name: 'David Kim', role: 'Project Manager', email: 'david.kim@univ.edu', tasksCount: 2, avatar: 'https://placehold.co/40x40/f59e0b/ffffff?text=DK' },
                    { name: 'Alex Turner', role: 'Fullstack Developer', email: 'alex.turner@univ.edu', tasksCount: 3, avatar: 'https://placehold.co/40x40/6b7280/ffffff?text=AT' }
                ],
                tasks: [], // No tasks for this project in the example
                files: [],
                discussion: []
            },
            {
                id: 'fitness-app',
                title: 'Fitness Tracker App',
                status: 'Completed',
                description: 'Mobile application to track workouts, nutrition, and health metrics with personalized plans.',
                image: 'https://placehold.co/600x300/8b5cf6/ffffff?text=Fitness+App',
                progress: 100,
                dueDate: '2025-06-10', // Completed date
                department: 'Mobile Development',
                type: 'Client Project',
                supervisor: 'Mr. John Doe',
                team: [
                    { name: 'Lisa Park', role: 'Lead Developer', email: 'lisa.park@univ.edu', tasksCount: 4, avatar: 'https://placehold.co/40x40/ec4899/ffffff?text=LP' },
                    { name: 'James Wilson', role: 'UI/UX Designer', email: 'james.wilson@univ.edu', tasksCount: 2, avatar: 'https://placehold.co/40x40/0d9488/ffffff?text=JW' },
                    { name: 'Olivia Smith', role: 'QA Engineer', email: 'olivia.smith@univ.edu', tasksCount: 1, avatar: 'https://placehold.co/40x40/facc15/ffffff?text=OS' }
                ],
                tasks: [],
                files: [],
                discussion: []
            }
        ];

        let currentProject = projects[0]; // Default to the first project for details view

        // --- Utility Functions ---
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            return DateTime.fromISO(dateString).toFormat('MMM dd, yyyy');
        }

        function getPriorityColor(priority) {
            switch (priority) {
                case 'High': return 'bg-red-100 text-red-800';
                case 'Medium': return 'bg-yellow-100 text-yellow-800';
                case 'Low': return 'bg-blue-100 text-blue-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getStatusColor(status) {
            switch (status) {
                case 'In Progress': return 'bg-green-100 text-green-800';
                case 'Pending': return 'bg-yellow-100 text-yellow-800';
                case 'Completed': return 'bg-purple-100 text-purple-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // --- Render Functions ---

        function renderSummaryCards() {
            const total = projects.length;
            const completed = projects.filter(p => p.status === 'Completed').length;
            const ongoing = projects.filter(p => p.status === 'In Progress').length;
            const upcomingDeadlines = projects.filter(p => p.status !== 'Completed' && DateTime.fromISO(p.dueDate) > DateTime.now()).length;

            document.getElementById('totalProjectsSummary').textContent = total;
            document.getElementById('completedProjectsSummary').textContent = completed;
            document.getElementById('ongoingProjectsSummary').textContent = ongoing;
            document.getElementById('upcomingDeadlinesSummary').textContent = upcomingDeadlines;
            document.getElementById('totalProjectsCount').textContent = total; // Sidebar count
        }

        function renderProjects(filteredProjects = projects) {
            const projectsGrid = document.getElementById('projectsGrid');
            projectsGrid.innerHTML = ''; // Clear existing projects

            if (filteredProjects.length === 0) {
                projectsGrid.innerHTML = '<p class="text-gray-600 col-span-full text-center py-8">No projects found matching your search.</p>';
                return;
            }

            filteredProjects.forEach(project => {
                const statusClass = getStatusColor(project.status);
                const dueDateText = project.status === 'Completed' ? `Completed: ${formatDate(project.dueDate)}` : `Due: ${formatDate(project.dueDate)}`;
                const teamAvatars = project.team.slice(0, 3).map(member => `<img src="${member.avatar}" alt="Team member avatar for ${member.name}" class="h-8 w-8 rounded-full border-2 border-white">`).join('');
                const remainingMembers = project.team.length > 3 ? `<span class="inline-flex items-center justify-center h-8 w-8 rounded-full border-2 border-white bg-gray-100 text-xs font-medium text-gray-500">+${project.team.length - 3}</span>` : '';

                projectsGrid.innerHTML += `
                    <div class="bg-white rounded-lg shadow overflow-hidden hover:shadow-md transition-shadow duration-300 cursor-pointer" data-project-id="${project.id}">
                        <img src="${project.image}" alt="${project.title} image" class="h-48 w-full object-cover">
                        <div class="p-6">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-800">${project.title}</h3>
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">${project.status}</span>
                            </div>
                            <p class="mt-2 text-sm text-gray-500">${project.description.substring(0, 100)}...</p>
                            <div class="mt-4">
                                <div class="flex justify-between text-xs text-gray-500 mb-1">
                                    <span>Progress</span>
                                    <span>${project.progress}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: ${project.progress}%"></div>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center justify-between">
                                <div class="flex -space-x-2">
                                    ${teamAvatars}
                                    ${remainingMembers}
                                </div>
                                <span class="text-xs text-gray-500">${dueDateText}</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            // Add event listeners to project cards
            document.querySelectorAll('#projectsGrid .bg-white').forEach(card => {
                card.addEventListener('click', function() {
                    const projectId = this.dataset.projectId;
                    const selectedProject = projects.find(p => p.id === projectId);
                    if (selectedProject) {
                        currentProject = selectedProject; // Set the current project
                        renderProjectDetails(selectedProject);
                        document.getElementById('projects').classList.add('hidden');
                        document.getElementById('project-details').classList.remove('hidden');
                    }
                });
            });
        }

        function renderProjectDetails(project) {
            document.getElementById('projectDetailTitle').textContent = project.title;
            document.getElementById('projectDetailDescription').textContent = project.description;
            document.getElementById('projectDetailDepartment').textContent = project.department;
            document.getElementById('projectDetailType').textContent = project.type;
            document.getElementById('projectDetailSupervisor').textContent = project.supervisor;
            document.getElementById('projectDetailStartDate').textContent = formatDate(project.startDate || '2025-08-01'); // Default if not present
            document.getElementById('projectDetailEndDate').textContent = formatDate(project.dueDate);
            document.getElementById('projectDetailStatus').innerHTML = `<span class="px-2 py-1 rounded-full ${getStatusColor(project.status)} text-xs font-medium">${project.status}</span>`;
            document.getElementById('projectDetailProgress').style.width = `${project.progress}%`;
            document.getElementById('projectDetailProgressText').textContent = `${project.progress}% completed`;

            // Render Team Members
            const teamMembersTableBody = document.getElementById('projectDetailTeamMembers');
            teamMembersTableBody.innerHTML = '';
            project.team.forEach(member => {
                teamMembersTableBody.innerHTML += `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <img src="${member.avatar}" alt="Team member avatar for ${member.name}" class="h-10 w-10 rounded-full">
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">${member.name}</div>
                                    <div class="text-sm text-gray-500">${member.role}</div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">${member.role.split(' ')[0]}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${member.email}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <div class="flex -space-x-1">
                                <span class="inline-flex items-center justify-center h-6 w-6 rounded-full bg-gray-200 text-xs font-medium text-gray-700">${member.tasksCount}</span>
                            </div>
                        </td>
                    </tr>
                `;
            });

            // Render Kanban Tasks
            renderKanbanTasks(project.tasks);

            // Render Files & Documents
            const filesContainer = document.getElementById('projectDetailFiles');
            filesContainer.innerHTML = '';
            project.files.forEach(file => {
                filesContainer.innerHTML += `
                    <div class="bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg ${file.bgColor} ${file.textColor}">
                                ${file.icon}
                            </div>
                            <div class="ml-4">
                                <h4 class="text-sm font-medium text-gray-900">${file.name}</h4>
                                <p class="text-xs text-gray-500">${file.type} - ${file.size}</p>
                                <p class="text-xs text-gray-400 mt-1">Uploaded: ${formatDate(file.uploaded)}</p>
                            </div>
                        </div>
                    </div>
                `;
            });

            // Render Discussion Comments
            const discussionContainer = document.getElementById('discussionComments');
            discussionContainer.innerHTML = '';
            project.discussion.forEach(comment => {
                let repliesHtml = '';
                if (comment.replies && comment.replies.length > 0) {
                    repliesHtml = comment.replies.map(reply => `
                        <div class="mt-4 flex">
                            <div class="flex-shrink-0">
                                <img src="${reply.avatar}" alt="User avatar of ${reply.user}" class="h-8 w-8 rounded-full">
                            </div>
                            <div class="ml-3">
                                <div class="flex items-center">
                                    <h4 class="text-sm font-medium text-gray-900">${reply.user}</h4>
                                    <span class="ml-2 text-xs text-gray-500">${reply.time}</span>
                                </div>
                                <div class="mt-1 text-sm text-gray-700">
                                    <p>${reply.text}</p>
                                </div>
                                <div class="mt-2 flex space-x-4 text-xs text-gray-500">
                                    <button class="hover:text-gray-700">Like</button>
                                    <button class="hover:text-gray-700">Reply</button>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }

                discussionContainer.innerHTML += `
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <img src="${comment.avatar}" alt="User avatar of ${comment.user}" class="h-10 w-10 rounded-full">
                        </div>
                        <div class="ml-4">
                            <div class="flex items-center">
                                <h4 class="text-sm font-medium text-gray-900">${comment.user}</h4>
                                <span class="ml-2 text-xs text-gray-500">${comment.time}</span>
                            </div>
                            <div class="mt-1 text-sm text-gray-700">
                                <p>${comment.text}</p>
                            </div>
                            <div class="mt-2 flex space-x-4 text-xs text-gray-500">
                                <button class="hover:text-gray-700">Like</button>
                                <button class="hover:text-gray-700">Reply</button>
                            </div>
                            ${repliesHtml}
                        </div>
                    </div>
                `;
            });
        }

        function renderKanbanTasks(tasks) {
            const todoTasksContainer = document.getElementById('todoTasks');
            const inProgressTasksContainer = document.getElementById('inProgressTasks');
            const doneTasksContainer = document.getElementById('doneTasks');

            todoTasksContainer.innerHTML = '';
            inProgressTasksContainer.innerHTML = '';
            doneTasksContainer.innerHTML = '';

            let todoCount = 0;
            let inProgressCount = 0;
            let doneCount = 0;

            tasks.forEach(task => {
                const priorityClass = getPriorityColor(task.priority);
                const assigneeAvatar = currentProject.team.find(member => member.name === task.assignee)?.avatar || 'https://placehold.co/40x40/cccccc/ffffff?text=NA';

                const taskHtml = `
                    <div class="bg-white p-4 rounded-lg shadow-sm kanban-card" draggable="true" data-task-id="${task.id}" data-task-status="${task.status}">
                        <div class="flex items-start justify-between">
                            <div>
                                <h5 class="text-sm font-medium text-gray-800">${task.title}</h5>
                                <p class="text-xs text-gray-500 mt-1">${task.description}</p>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z" />
                                </svg>
                            </button>
                        </div>
                        <div class="mt-3 flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
                                </svg>
                                Due: ${formatDate(task.dueDate)}
                            </div>
                            <span class="px-2 py-0.5 text-xs font-medium rounded-full ${priorityClass}">${task.priority}</span>
                        </div>
                        <div class="mt-3 flex items-center">
                            <img src="${assigneeAvatar}" alt="Assigned team member ${task.assignee}" class="h-6 w-6 rounded-full border-2 border-white -ml-1">
                            <span class="ml-1 text-xs text-gray-500">Assigned to ${task.assignee.split(' ')[0]}</span>
                        </div>
                    </div>
                `;

                if (task.status === 'To Do') {
                    todoTasksContainer.innerHTML += taskHtml;
                    todoCount++;
                } else if (task.status === 'In Progress') {
                    inProgressTasksContainer.innerHTML += taskHtml;
                    inProgressCount++;
                } else if (task.status === 'Done') {
                    doneTasksContainer.innerHTML += taskHtml;
                    doneCount++;
                }
            });

            document.getElementById('todoCount').textContent = todoCount;
            document.getElementById('inProgressCount').textContent = inProgressCount;
            document.getElementById('doneCount').textContent = doneCount;

            // Add drag and drop listeners
            addDragAndDropListeners();
        }

        function renderRecentActivity() {
            const activityList = document.getElementById('recentActivityList');
            activityList.innerHTML = '';

            const activities = [
                { user: 'Sarah Johnson', avatar: 'https://placehold.co/40x40/8b5cf6/ffffff?text=SJ', action: 'created a new task in', project: 'AI Healthcare Chatbot', detail: 'API Integration for NLP Module', time: '2 hours ago' },
                { user: 'Michael Chen', avatar: 'https://placehold.co/40x40/3b82f6/ffffff?text=MC', action: 'completed the task', detail: 'UI Wireframes', time: '5 hours ago' },
                { user: 'Emma Williams', avatar: 'https://placehold.co/40x40/10b981/ffffff?text=EW', action: 'uploaded a file to', project: 'Marketing Strategy', detail: 'Q3_Marketing_Plan.pdf', time: '1 day ago' },
                { user: 'David Kim', avatar: 'https://placehold.co/40x40/f59e0b/ffffff?text=DK', action: 'commented on', project: 'Mobile App Development', detail: '"Let\'s discuss the UX improvements..."', time: '2 days ago' },
                { user: 'Admin User', avatar: 'https://placehold.co/40x40', action: 'updated project status for', project: 'E-commerce Platform', detail: 'Progress to 15%', time: '3 days ago' }
            ];

            activities.forEach(activity => {
                activityList.innerHTML += `
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <img src="${activity.avatar}" alt="User avatar of ${activity.user}" class="h-8 w-8 rounded-full">
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-gray-800">
                                <span class="font-medium">${activity.user}</span> ${activity.action} 
                                ${activity.project ? `<span class="font-medium">${activity.project}</span>` : ''}
                            </p>
                            <p class="text-xs text-gray-500">${activity.detail}</p>
                            <p class="text-xs text-gray-400 mt-1">${activity.time}</p>
                        </div>
                    </div>
                `;
            });
        }

        function renderCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';

            const now = DateTime.now();
            const startOfMonth = now.startOf('month');
            const endOfMonth = now.endOf('month');
            const startDay = startOfMonth.weekday === 7 ? 0 : startOfMonth.weekday; // 0 for Sunday, 1 for Monday...
            const daysInMonth = endOfMonth.day;

            // Get all upcoming deadlines from projects and tasks
            const allDeadlines = [];
            projects.forEach(project => {
                if (project.status !== 'Completed') {
                    allDeadlines.push({
                        date: project.dueDate,
                        title: project.title,
                        type: 'Project',
                        color: 'bg-blue-100 text-blue-800'
                    });
                }
                project.tasks.forEach(task => {
                    if (task.status !== 'Done') {
                        allDeadlines.push({
                            date: task.dueDate,
                            title: task.title,
                            type: 'Task',
                            color: getPriorityColor(task.priority)
                        });
                    }
                });
            });

            // Sort deadlines by date
            allDeadlines.sort((a, b) => DateTime.fromISO(a.date).toMillis() - DateTime.fromISO(b.date).toMillis());

            // Fill leading empty days
            for (let i = 0; i < startDay; i++) {
                calendarGrid.innerHTML += `<div class="h-28 p-1 border-b border-gray-200"><div class="text-xs text-gray-500 text-right p-1">${startOfMonth.minus({ days: startDay - i }).day}</div></div>`;
            }

            // Fill days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const currentDay = startOfMonth.set({ day: day });
                const isToday = currentDay.hasSame(now, 'day');
                const dayClass = isToday ? 'bg-blue-50 ring-1 ring-blue-500' : '';
                const textColor = isToday ? 'text-blue-900 font-bold' : 'text-gray-900';

                let eventsHtml = '';
                const dayEvents = allDeadlines.filter(event => DateTime.fromISO(event.date).hasSame(currentDay, 'day'));
                dayEvents.forEach(event => {
                    eventsHtml += `
                        <a href="#" class="block px-1 py-0.5 text-xs rounded ${event.color} truncate mt-1">
                            ${event.title}
                        </a>
                    `;
                });

                calendarGrid.innerHTML += `
                    <div class="h-28 p-1 border-b border-gray-200 ${dayClass}">
                        <div class="text-xs ${textColor} text-right p-1">${day}</div>
                        <div class="mt-1 space-y-0.5">
                            ${eventsHtml}
                        </div>
                    </div>
                `;
            }

            // Fill trailing empty days
            const totalCells = startDay + daysInMonth;
            const remainingCells = 42 - totalCells; // Ensure 6 rows (6 * 7 = 42 cells)
            for (let i = 1; i <= remainingCells; i++) {
                calendarGrid.innerHTML += `<div class="h-28 p-1 border-b border-gray-200"><div class="text-xs text-gray-500 text-right p-1">${endOfMonth.plus({ days: i }).day}</div></div>`;
            }
        }


        // --- Event Listeners and Initial Load ---

        document.addEventListener('DOMContentLoaded', function() {
            // Toggle Sidebar
            document.getElementById('toggleSidebar').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('sidebar-mini');
                sidebar.classList.toggle('sidebar-full');
            });

            // Chart.js Example
            const ctx = document.getElementById('statusChart').getContext('2d');
            const statusChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Completed', 'In Progress', 'Pending'],
                    datasets: [{
                        label: 'Number of Projects',
                        data: [
                            projects.filter(p => p.status === 'Completed').length,
                            projects.filter(p => p.status === 'In Progress').length,
                            projects.filter(p => p.status === 'Pending').length
                        ],
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.6)', // Greenish for Completed
                            'rgba(255, 206, 86, 0.6)', // Yellowish for In Progress
                            'rgba(255, 99, 132, 0.6)'  // Reddish for Pending
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0 // Ensure integer ticks
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // New Task Modal Logic
            document.getElementById('newTaskButton').addEventListener('click', function() {
                document.getElementById('newTaskModal').classList.remove('hidden');
                // Pre-fill deadline with a week from now
                document.getElementById('taskDeadline').value = DateTime.now().plus({ weeks: 1 }).toISODate();
            });

            document.getElementById('cancelTaskButton').addEventListener('click', function() {
                document.getElementById('newTaskModal').classList.add('hidden');
                // Clear form fields
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskAssignee').value = 'Sarah Johnson';
                document.getElementById('taskPriority').value = 'High';
            });

            document.getElementById('createTaskButton').addEventListener('click', function() {
                const title = document.getElementById('taskTitle').value;
                const description = document.getElementById('taskDescription').value;
                const assignee = document.getElementById('taskAssignee').value;
                const priority = document.getElementById('taskPriority').value;
                const deadline = document.getElementById('taskDeadline').value;

                if (title && description && assignee && deadline) {
                    const newTask = {
                        id: `task${currentProject.tasks.length + 1}`, // Simple ID generation
                        title: title,
                        description: description,
                        assignee: assignee,
                        dueDate: deadline,
                        priority: priority,
                        status: 'To Do' // New tasks start in To Do
                    };

                    currentProject.tasks.push(newTask);
                    renderKanbanTasks(currentProject.tasks); // Re-render Kanban board
                    document.getElementById('newTaskModal').classList.add('hidden');
                    
                    // Add activity for new task
                    const newActivity = {
                        user: 'Admin User', // Assuming admin creates
                        avatar: 'https://placehold.co/40x40',
                        action: 'created a new task in',
                        project: currentProject.title,
                        detail: newTask.title,
                        time: 'just now'
                    };
                    // Prepend to activities for display (for demo purposes)
                    const activityListElement = document.getElementById('recentActivityList');
                    const newActivityHtml = `
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <img src="${newActivity.avatar}" alt="User avatar of ${newActivity.user}" class="h-8 w-8 rounded-full">
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-gray-800">
                                    <span class="font-medium">${newActivity.user}</span> ${newActivity.action} 
                                    ${newActivity.project ? `<span class="font-medium">${newActivity.project}</span>` : ''}
                                </p>
                                <p class="text-xs text-gray-500">${newActivity.detail}</p>
                                <p class="text-xs text-gray-400 mt-1">${newActivity.time}</p>
                            </div>
                        </div>
                    `;
                    activityListElement.insertAdjacentHTML('afterbegin', newActivityHtml);

                    // Clear form fields
                    document.getElementById('taskTitle').value = '';
                    document.getElementById('taskDescription').value = '';
                    document.getElementById('taskAssignee').value = 'Sarah Johnson';
                    document.getElementById('taskPriority').value = 'High';
                } else {
                    alert('Please fill in all task fields.');
                }
            });

            // Back to Projects button
            document.getElementById('backToProjects').addEventListener('click', function() {
                document.getElementById('project-details').classList.add('hidden');
                document.getElementById('projects').classList.remove('hidden');
            });

            // Project Search functionality
            document.getElementById('projectSearch').addEventListener('keyup', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredProjects = projects.filter(project => 
                    project.title.toLowerCase().includes(searchTerm) ||
                    project.description.toLowerCase().includes(searchTerm)
                );
                renderProjects(filteredProjects);
            });

            // Initial renders
            renderSummaryCards();
            renderProjects();
            renderProjectDetails(currentProject); // Render details for the default project
            renderRecentActivity();
            renderCalendar();
        });

        // --- Drag and Drop for Kanban Board ---
        let draggedItem = null;

        function addDragAndDropListeners() {
            const kanbanCards = document.querySelectorAll('.kanban-card');
            const kanbanColumns = document.querySelectorAll('.kanban-column');

            kanbanCards.forEach(card => {
                card.addEventListener('dragstart', (e) => {
                    draggedItem = card;
                    setTimeout(() => {
                        card.style.opacity = '0.5';
                    }, 0);
                });

                card.addEventListener('dragend', () => {
                    draggedItem.style.opacity = '1';
                    draggedItem = null;
                });
            });

            kanbanColumns.forEach(column => {
                column.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Allow drop
                });

                column.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    column.classList.add('bg-gray-100'); // Visual feedback
                });

                column.addEventListener('dragleave', () => {
                    column.classList.remove('bg-gray-100');
                });

                column.addEventListener('drop', (e) => {
                    e.preventDefault();
                    column.classList.remove('bg-gray-100');

                    if (draggedItem) {
                        const targetColumnId = column.querySelector('h4').textContent.trim(); // "To Do", "In Progress", "Done"
                        const taskId = draggedItem.dataset.taskId;

                        // Update task status in data
                        const taskIndex = currentProject.tasks.findIndex(task => task.id === taskId);
                        if (taskIndex > -1) {
                            currentProject.tasks[taskIndex].status = targetColumnId;
                            renderKanbanTasks(currentProject.tasks); // Re-render the board to reflect changes
                        }
                    }
                });
            });
        }
    </script>
</body>
</html>
